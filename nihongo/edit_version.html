<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
<script src="QAList.js"></script>
<script src="version_log.js"></script>
</head>
<body>
<div id="rsText" style="position:absolute;width:100%;top:5%;">
</div>
<script>
/*
<input type='text' id='inputText' value='' onKeyDown='handleKey()'></input>
function handleKey(e)
{
	if(typeof e == "undefined" || (!e))
		e = window.event;
		
	if(e.keyCode == 13){
		var now = new Date();
		now.setTime(now.getTime()+1000*60*60*24*365);
		document.cookie = "verd="+document.getElementById("inputText").value+";expires="+now.toGMTString();
	}
}*/
var cookieKeyhead = "ac";
var versionKeyhead = "verd";
var params = QAList[QAList.length-1];
if(document.cookie){
	var accStack = new Array();
	var subc = document.cookie.split(';');
	for (var i = 0; i < subc.length; i++){
		var khidx = subc[i].indexOf(cookieKeyhead);
		if(khidx != -1){
			var vhidx = subc[i].indexOf("=");
			var acchidx = Number(subc[i].substr(khidx+2,1));
			var accvs = subc[i].substr(vhidx+1);
			if(accvs.length%2 == 0){
				for(var j = 0; j < accvs.length / 2; j++){
					var accv = Number(subc[i].substr(vhidx+1+j*2,2));
					QAList[j*10+acchidx]["accr"] = accv;
				}
			}
		}
	}
	for (var i = 0; i < subc.length; i++){
		var khidx = subc[i].indexOf(versionKeyhead);
		var vhidx = subc[i].indexOf("=");
		if(khidx != -1){
			var last_ver = Number(subc[i].slice(vhidx+1));
			readVersion(last_ver);
		}
	}
}

function readVersion(lastVer)
{
var rsText = "";
	var accTemp = new Array();
	for(var i = 0; i < QAList.length-1; i++){
		accTemp.push(QAList[i]["accr"]);
	}
//
rsText += "accTemp0:<br>";
for(var a = 0; a < QAList.length-1; a++){
	rsText += QAList[a]["que"]+" "+accTemp[a]+"<br>";
}
rsText += "<br>";
//
	for(var i = 0; i < version_log.length-1; i++){
		if(version_log[i]["verd"] > lastVer){
			var newAcc = new Array();
			for(var j = 0; j < QAList.length-1; j++){
				newAcc.push(-1);
			}
//
rsText += "newAcc0:<br>";
for(var a = 0; a < QAList.length-1; a++){
	rsText += QAList[a]["que"]+" "+newAcc[a]+"<br>";
}
rsText += "<br>";
//
			for(var k in version_log[i]["changed"]){
				newAcc[k] = 0;
			}
//
rsText += "newAcc1:<br>";
for(var a = 0; a < QAList.length-1; a++){
	rsText += QAList[a]["que"]+" "+newAcc[a]+"<br>";
}
rsText += "<br>";
//
			for(var k in version_log[i]["changed"]){
				var v = version_log[i]["changed"][k];
				if(v >= 0){
					newAcc[v] = accTemp[k];
				}
			}
//
rsText += "newAcc2:<br>";
for(var a = 0; a < QAList.length-1; a++){
	rsText += QAList[a]["que"]+" "+newAcc[a]+"<br>";
}
rsText += "<br>";
//
			for(var j = 0; j < QAList.length-1; j++){
				if(newAcc[j] >= 0){
					accTemp[j] = newAcc[j];
				}
			}
//
rsText += "accTemp1:<br>";
for(var a = 0; a < QAList.length-1; a++){
	rsText += QAList[a]["que"]+" "+accTemp[a]+"<br>";
}
rsText += "<br>";
//
		}
	}
	
	for(var i = 0; i < QAList.length-1; i++){
		QAList[i]["accr"] = accTemp[i];
	}
	
document.getElementById("rsText").innerHTML = rsText;
}
</script>
</body>
</html>